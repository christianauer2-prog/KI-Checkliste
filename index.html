  <!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KI-Vertriebsreife Checkliste</title>
</head>
<body>
<!-- TEMP: MODAL & BUTTON SECTION START -->
<style id="n8n-modal-styles">
.recommendation-modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; }
.recommendation-modal.show { display: flex; }
.modal-inner { background: white; padding: 30px; border-radius: 8px; max-width: 400px; width: 90%; }
.modal-inner h3 { color: #5ba3c4; margin-bottom: 20px; }
.modal-field { margin-bottom: 15px; }
.modal-field label { display: block; margin-bottom: 5px; font-weight: 600; color: #333; }
.modal-field input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
.modal-actions { display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end; }
.modal-actions button { margin: 0; padding: 10px 20px; font-size: 14px; }
.modal-actions .cancel-btn { background: #ddd; color: #333; }
#actionButtons { margin-top: 20px; text-align: center; }
#requestBtn { background: #5ba3c4; color: white; padding: 12px 30px; }
</style>
<div id="recommendationModal" class="recommendation-modal">
  <div class="modal-inner">
    <h3>Handlungsempfehlung anfordern</h3>
    <div class="modal-field"><label>Vorname:</label><input type="text" id="modalFirstName" placeholder="Max"></div>
    <div class="modal-field"><label>Nachname:</label><input type="text" id="modalLastName" placeholder="Mustermann"></div>
    <div class="modal-field"><label>Email:</label><input type="email" id="modalEmail" placeholder="max@example.com"></div>
    <div class="modal-actions">
      <button class="cancel-btn" onclick="closeRecommendationModal()">Abbrechen</button>
      <button onclick="submitRecommendationRequest()">Senden</button>
    </div>
  </div>
</div>
<!-- TEMP: MODAL & BUTTON SECTION END -->

<!-- N8N INTEGRATION FUNCTIONS START -->
<script id="n8n-integration">
// N8N Webhook Configuration
const N8N_WEBHOOK_URL = 'https://christianauer.app.n8n.cloud/webhook/a0b4ddb5-8d2f-44ec-bc1e-b6de900f7199';

function openRecommendationModal() {
  document.getElementById('recommendationModal').classList.add('show');
}

function closeRecommendationModal() {
  document.getElementById('recommendationModal').classList.remove('show');
}

function collectFormData() {
  const data = {
    timestamp: new Date().toISOString(),
    sections: [],
    totalScore: document.getElementById('resultPercentage').textContent,
    userData: {
      firstName: document.getElementById('modalFirstName').value,
      lastName: document.getElementById('modalLastName').value,
      email: document.getElementById('modalEmail').value
    }
  };
  
  // Collect all question answers
  for(let i = 1; i <= 20; i++) {
    const radio = document.querySelector('input[name="q' + i + '"]:checked');
    if(radio) {
      data.sections.push({questionNumber: i, value: radio.value});
    }
  }
  
  return data;
}

async function submitRecommendationRequest() {
  const firstName = document.getElementById('modalFirstName').value;
  const lastName = document.getElementById('modalLastName').value;
  const email = document.getElementById('modalEmail').value;
  
  if(!firstName || !lastName || !email) {
    alert('Bitte fÃ¼llen Sie alle Felder aus');
    return;
  }
  
  const formData = collectFormData();
  
  try {
    const response = await fetch(https://christianauer.app.n8n.cloud/webhook/a0b4ddb5-8d2f-44ec-bc1e-b6de900f7199, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(formData)
    });
    
    if(response.ok) {
      alert('Anfrage gesendet! Sie erhalten einen Report per Email.');
      closeRecommendationModal();
      document.getElementById('modalFirstName').value = '';
      document.getElementById('modalLastName').value = '';
      document.getElementById('modalEmail').value = '';
    } else {
      alert('Fehler beim Senden der Anfrage');
    }
  } catch(error) {
    alert('Fehler: ' + error.message);
  }
}
</script>
<!-- N8N INTEGRATION FUNCTIONS END -->

<!-- ADD REQUEST BUTTON TO RESULT BOX -->
<script>
// This will add the request button after results are shown
const originalShowResults = () => {
  const actionButtons = document.createElement('div');
  actionButtons.id = 'actionButtons';
  actionButtons.innerHTML = '<button id="requestBtn" onclick="openRecommendationModal()">ðŸ“§ Handlungsempfehlung anfordern</button>';
  const resultBox = document.getElementById('resultBox');
  if(resultBox && !document.getElementById('actionButtons')) {
    resultBox.appendChild(actionButtons);
  }
};
</script>
</body>
</html>
